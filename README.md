# SPRING ADVANCED
2025.06.09~2025.06.12


## 코드 개선
### Lv 1-1. Early Return 적용
- AuthService 클래스의 signup()에서 중복 이메일 판별 if문을 메서드 최상단으로 이동
- **개선 전**: 이메일이 중복되어 회원가입이 실패하는 경우에도, 비밀번호 인코딩이 먼저 실행되어 낭비되는 연산이 발생 
- **개선 후**: 불필요한 인코딩 연산 제거로 성능 향상

### Lv 1-2. 불필요한 if-else 제거
- WeatherClient 클래스에 있는 getTodayWeather() 중 날씨 데이터가 있는지 판별하는 if문을 감싼 else문을 삭제
- 이전의 if문에서 참일 시 예외가 던져서 다음 로직이 실행되지 않으므로 else가 불필요한 상황이었음
- **개선 전**: 불필요한 else문으로 코드 가독성 저하
- **개선 후**: else문을 없애 비교적 간결한 코드 완성

### Lv 1-3. Validation 수정
- UserService 클래스의 changePassword()에서 비밀번호 유효성 검증을 DTO로 이동
- 검증에 실패할 시 예외를 GlobalExceptionHandler에서 처리하도록 구현
- **개선 전**: 서비스단에서 검증 처리
- **개선 후**: DTO에서 검증하고, 실패 시 GlobalExceptionHandler가 처리 → 책임 분리 및 효율성 증가

### Lv 2. N+1 문제
- TodoRepository에서 JPQL의 fetch join 대신 @EntityGraph 적용
- **개선 전**: ffetch join은 페이징 시 부정확한 count, 중복 row 발생 가능
- **개선 후**: @EntityGraph는 N+1 문제를 해결하면서도 정확한 페이징 지원

### Lv 3-1. matches 테스트 수정
- matches() 인수 순서 오류 수정
- **개선 전**: 잘못된 인수 순서로 테스트 비정상 작동
- **개선 후**: 테스트 정상 작동

### Lv 3-2. manager 목록 조회시 Todo가 없는 경우 예외 처리 테스트 수정
- 메서드명 및 비교 문자열 수정
- **개선 전**: 잘못된 문자열 비교로 테스트 비정상 작동
- **개선 후**: 테스트 정상 작동

### Lv 3-3. comment 등록 시 Todo가 없는 경우 예외 처리 테스트 수정
- 올바른 예외 타입으로 수정
- **개선 전**: 잘못된 예외 타입 설정으로 테스트 비정상 작동
- **개선 후**: 테스트 정상 작동

### Lv 3-4. 테스트를 기반으로 todo의 user가 null인 경우 예외 처리 되도록 수정
- Todo가 null인 경우 getID()를 null로 설정하는 로직을 추가
- **개선 전**: 테스트 결과 실패
- **개선 후**: 테스트 결과 성공

### Lv 4. API 로깅
- Interceptor를 활용하여 ADMIN 사용자만 접근 가능한 특정 API에 접근할 때 로깅 구현
- **개선 전**: -
- **개선 후**: 특정 API 접근 시 로그 출력

### Lv 5. DTO 팩토리 메서드 구현
- ResponseDTO 팩토리 메서드를 구현하여 이를 사용하도록 리팩토링
- **개선 전**: 직접 생성하여 코드가 길어지고 가독성이 좋지 않은 구간 존재
- **개선 후**: 가독성 향상, 유지보수가 쉬워짐
